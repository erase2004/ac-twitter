(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d42368e8"],{"01c8":function(e,t,s){"use strict";s("868e")},2416:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-room"},[s("section",{staticClass:"room-header"},[e._t("default")],2),s("section",{ref:"personalChatroom",staticClass:"message-container"},[s("div",{staticClass:"mt-auto"},e._l(e.proccessedMessage,(function(t){return s("div",{key:t.id,staticClass:"message-block",class:{"server-message":0===t.type,"self-message":1===t.type}},[1===t.type?s("div",{staticClass:"self"},[s("div",{staticClass:"message"},[e._v(" "+e._s(t.message)+" ")]),s("div",{staticClass:"time"},[e._v(" "+e._s(e._f("timeFormat")(t.created_at))+" ")])]):2===t.type?s("div",{staticClass:"user"},[s("div",{staticClass:"message-area"},[s("UserThumbnail",{staticClass:"avatar",attrs:{"initial-user":t.userData}}),s("div",{staticClass:"message"},[e._v(" "+e._s(t.message)+" ")])],1),s("div",{staticClass:"time"},[e._v(" "+e._s(e._f("timeFormat")(t.created_at))+" ")])]):s("div",{staticClass:"d-none"})])})),0)]),s("section",{staticClass:"control-group"},[s("input",{directives:[{name:"model",rawName:"v-model.lazy.trim",value:e.inputMessage,expression:"inputMessage",modifiers:{lazy:!0,trim:!0}}],attrs:{type:"text",name:"message",placeholder:"輸入訊息..."},domProps:{value:e.inputMessage},on:{change:function(t){e.inputMessage=t.target.value.trim()},blur:function(t){return e.$forceUpdate()}}}),s("icon",{staticClass:"btn-send cursor-pointer",attrs:{"icon-name":"message-send",disabled:e.isLoading},nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.sendMessage.apply(null,arguments)}}})],1)])},r=[],i=s("5530"),a=(s("d3b7"),s("6062"),s("3ca3"),s("ddb0"),s("4de4"),s("d81d"),s("d092")),o=s("2fa3"),c=s("2708"),u=s("2f62"),d=[{id:6,message:"asdfasdfawef",created_at:new Date,userData:{avatar:"https://loremflickr.com/320/240/woman/?random=25.130310387068057",id:1}},{id:7,message:"asdfasd23wqefawef",created_at:new Date,userData:{avatar:"https://loremflickr.com/320/240/woman/?random=25.130310387068057",id:2}}],f={components:{UserThumbnail:a["a"]},mixins:[c["e"],c["b"],c["c"]],data:function(){return{messages:[],inputMessage:"",isLoading:!0,id:""}},beforeRouteUpdate:function(e,t,s){var n=e.params.id;this.id=n,this.$socket.client.emit("createRoom",{sendUserId:this.currentUser.id,listenUserId:this.id}),console.log("current:",this.currentUser.id,"listen",this.id),s()},sockets:{},computed:Object(i["a"])(Object(i["a"])({},Object(u["b"])(["currentUser"])),{},{proccessedMessage:function(){var e=this,t=new Set,s=this.messages.filter((function(e){return!t.has(e.id)&&(t.add(e.id),!0)}));return s.map((function(t){return"server"===t.source?Object(i["a"])(Object(i["a"])({},t),{},{type:0}):t.userData.id===e.currentUser.id?Object(i["a"])(Object(i["a"])({},t),{},{type:1}):Object(i["a"])(Object(i["a"])({},t),{},{type:2})}))}}),watch:{proccessedMessage:function(){this.$nextTick((function(){var e=this.$refs.personalChatroom;e.scrollTop=e.scrollHeight}))}},created:function(){this.messages=d},methods:{sendMessage:function(){if(!this.isLoading){var e=this.checkInstantMessage(this.inputMessage),t=e.status,s=e.message;if(!1===t)return o["a"].fire({icon:"warning",title:s});this.$socket.client.emit("message",{source:"user",userId:this.currentUser.id,message:this.inputMessage}),this.inputMessage=""}}}},l=f,v=(s("dfd5"),s("2877")),p=Object(v["a"])(l,n,r,!1,null,"1cee72dc",null);t["default"]=p.exports},"4fad":function(e,t,s){var n=s("d039"),r=s("861d"),i=s("c6b6"),a=s("d86b"),o=Object.isExtensible,c=n((function(){o(1)}));e.exports=c||a?function(e){return!!r(e)&&((!a||"ArrayBuffer"!=i(e))&&(!o||o(e)))}:o},6062:function(e,t,s){"use strict";var n=s("6d61"),r=s("6566");n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},6566:function(e,t,s){"use strict";var n=s("9bf2").f,r=s("7c73"),i=s("e2cc"),a=s("0366"),o=s("19aa"),c=s("2266"),u=s("7dd0"),d=s("2626"),f=s("83ab"),l=s("f183").fastKey,v=s("69f3"),p=v.set,h=v.getterFor;e.exports={getConstructor:function(e,t,s,u){var d=e((function(e,n){o(e,v),p(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),f||(e.size=0),void 0!=n&&c(n,e[u],{that:e,AS_ENTRIES:s})})),v=d.prototype,m=h(t),g=function(e,t,s){var n,r,i=m(e),a=b(e,t);return a?a.value=s:(i.last=a={index:r=l(t,!0),key:t,value:s,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=a),n&&(n.next=a),f?i.size++:e.size++,"F"!==r&&(i.index[r]=a)),e},b=function(e,t){var s,n=m(e),r=l(t);if("F"!==r)return n.index[r];for(s=n.first;s;s=s.next)if(s.key==t)return s};return i(v,{clear:function(){var e=this,t=m(e),s=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete s[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:e.size=0},delete:function(e){var t=this,s=m(t),n=b(t,e);if(n){var r=n.next,i=n.previous;delete s.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),s.first==n&&(s.first=r),s.last==n&&(s.last=i),f?s.size--:t.size--}return!!n},forEach:function(e){var t,s=m(this),n=a(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:s.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),i(v,s?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),f&&n(v,"size",{get:function(){return m(this).size}}),d},setStrong:function(e,t,s){var n=t+" Iterator",r=h(t),i=h(n);u(e,t,(function(e,t){p(this,{type:n,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=i(this),t=e.kind,s=e.last;while(s&&s.removed)s=s.previous;return e.target&&(e.last=s=s?s.next:e.state.first)?"keys"==t?{value:s.key,done:!1}:"values"==t?{value:s.value,done:!1}:{value:[s.key,s.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),s?"entries":"values",!s,!0),d(t)}}},"6d61":function(e,t,s){"use strict";var n=s("23e7"),r=s("da84"),i=s("e330"),a=s("94ca"),o=s("6eeb"),c=s("f183"),u=s("2266"),d=s("19aa"),f=s("1626"),l=s("861d"),v=s("d039"),p=s("1c7e"),h=s("d44e"),m=s("7156");e.exports=function(e,t,s){var g=-1!==e.indexOf("Map"),b=-1!==e.indexOf("Weak"),x=g?"set":"add",w=r[e],y=w&&w.prototype,k=w,O={},j=function(e){var t=i(y[e]);o(y,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(b&&!l(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return b&&!l(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!l(e))&&t(this,0===e?0:e)}:function(e,s){return t(this,0===e?0:e,s),this})},_=a(e,!f(w)||!(b||y.forEach&&!v((function(){(new w).entries().next()}))));if(_)k=s.getConstructor(t,e,g,x),c.enable();else if(a(e,!0)){var C=new k,M=C[x](b?{}:-0,1)!=C,U=v((function(){C.has(1)})),z=p((function(e){new w(e)})),E=!b&&v((function(){var e=new w,t=5;while(t--)e[x](t,t);return!e.has(-0)}));z||(k=t((function(e,t){d(e,y);var s=m(new w,e,k);return void 0!=t&&u(t,s[x],{that:s,AS_ENTRIES:g}),s})),k.prototype=y,y.constructor=k),(U||E)&&(j("delete"),j("has"),g&&j("get")),(E||M)&&j(x),b&&y.clear&&delete y.clear}return O[e]=k,n({global:!0,forced:k!=w},O),h(k,e),b||s.setStrong(k,e,g),k}},"868e":function(e,t,s){},9862:function(e,t,s){},bb2f:function(e,t,s){var n=s("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d092:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("router-link",{staticClass:"photo-container",attrs:{to:{name:"user-main",params:{id:e.user.id}}}},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.user.avatar,expression:"user.avatar"}],attrs:{src:e.user.avatar},on:{error:function(t){e.user.avatar=""}}})])},r=[],i=s("5530"),a={props:{initialUser:{type:Object,required:!0}},data:function(){return{user:{id:-1,avatar:""}}},watch:{initialUser:function(e){this.user=Object(i["a"])(Object(i["a"])({},this.user),e)}},created:function(){this.user=Object(i["a"])(Object(i["a"])({},this.user),this.initialUser)}},o=a,c=(s("01c8"),s("2877")),u=Object(c["a"])(o,n,r,!1,null,"34e062da",null);t["a"]=u.exports},d86b:function(e,t,s){var n=s("d039");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},dfd5:function(e,t,s){"use strict";s("9862")},f183:function(e,t,s){var n=s("23e7"),r=s("e330"),i=s("d012"),a=s("861d"),o=s("1a2d"),c=s("9bf2").f,u=s("241c"),d=s("057f"),f=s("4fad"),l=s("90e3"),v=s("bb2f"),p=!1,h=l("meta"),m=0,g=function(e){c(e,h,{value:{objectID:"O"+m++,weakData:{}}})},b=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,h)){if(!f(e))return"F";if(!t)return"E";g(e)}return e[h].objectID},x=function(e,t){if(!o(e,h)){if(!f(e))return!0;if(!t)return!1;g(e)}return e[h].weakData},w=function(e){return v&&p&&f(e)&&!o(e,h)&&g(e),e},y=function(){k.enable=function(){},p=!0;var e=u.f,t=r([].splice),s={};s[h]=1,e(s).length&&(u.f=function(s){for(var n=e(s),r=0,i=n.length;r<i;r++)if(n[r]===h){t(n,r,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},k=e.exports={enable:y,fastKey:b,getWeakData:x,onFreeze:w};i[h]=!0}}]);
//# sourceMappingURL=chunk-d42368e8.16ce0bcc.js.map