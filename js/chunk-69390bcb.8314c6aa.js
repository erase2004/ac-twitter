(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69390bcb"],{"01c8":function(t,e,r){"use strict";r("868e")},"08b7":function(t,e,r){},"209d":function(t,e,r){},2441:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"site-nav"},[r("div",{staticClass:"main-part"},[r("router-link",{staticClass:"logo",attrs:{to:{name:"homepage"}}},[r("icon",{attrs:{"icon-name":"logo"}})],1),r("section",{staticClass:"nav-container"},[r("router-link",{staticClass:"nav-link link-group",class:{active:["homepage","tweet"].includes(t.$route.name)},attrs:{to:{name:"homepage"}}},[r("icon",{attrs:{"icon-name":"home","icon-class":"mr-20"}}),r("div",{staticClass:"link-text"},[t._v(" 首頁 ")])],1),r("router-link",{staticClass:"nav-link link-group",class:{active:["user-tweets","user-replies","user-likes"].includes(t.$route.name)}&&t.$route.params.id===t.currentUser.id,attrs:{to:{name:"user-main",params:{id:t.currentUser.id}}}},[r("icon",{attrs:{"icon-name":"user","icon-class":"mr-20"}}),r("div",{staticClass:"link-text"},[t._v(" 個人資料 ")])],1),r("router-link",{staticClass:"nav-link link-group",attrs:{to:{name:"user-setting"}}},[r("icon",{attrs:{"icon-name":"setting","icon-class":"mr-20"}}),r("div",{staticClass:"link-text"},[t._v(" 設定 ")])],1)],1),r("button",{staticClass:"btn-control btn-tweet",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openModal.apply(null,arguments)}}},[t._v(" 推文 ")])],1),r("div",{staticClass:"link-group logout-part"},[r("icon",{attrs:{"icon-name":"logout","icon-class":"mr-20"}}),r("div",{staticClass:"link-text",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.logout.apply(null,arguments)}}},[t._v(" 登出 ")])],1),r("portal",{attrs:{to:"modals"}},[r("TweetModal",{attrs:{order:1,show:t.show},on:{close:t.closeModal}})],1)],1)},n=[],a=r("5530"),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("transition",{attrs:{name:"fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}]},[r("div",{staticClass:"modal show tweet-modal",attrs:{tabindex:"-1",role:"dialog"},on:{click:function(e){return e.target!==e.currentTarget?null:t.close.apply(null,arguments)}}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[r("icon",{staticClass:"icon-close cursor-pointer",attrs:{"icon-name":"cross"},nativeOn:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.close.apply(null,arguments)}}})],1),r("div",{staticClass:"modal-body"},[r("TweetBox",{attrs:{"error-message":t.errorMessage},on:{"after-tweet":function(e){return t.handleNewTweet(e)},"update-error":function(e){t.errorMessage=e}}})],1)])])]),r("div",{staticClass:"modal-backdrop show"})])])},i=[],c=(r("b0c0"),r("a9e3"),r("769e")),u={components:{TweetBox:c["a"]},props:{show:{type:Boolean,required:!0,default:!1}},data:function(){return{errorMessage:""}},watch:{show:function(t,e){!1===t&&(this.errorMessage="")}},methods:{close:function(){this.$emit("close")},handleNewTweet:function(t){var e=this.$route;"homepage"===e.name||"user-tweets"===e.name&&t.userData.id===Number(e.params.id)?(this.$store.commit("produceTweet",t),this.close()):(this.close(),this.$router.push({name:"homepage"}))}}},l=u,d=(r("59f9"),r("2877")),f=Object(d["a"])(l,o,i,!1,null,"c8c3e3aa",null),p=f.exports,m=r("2f62"),v={components:{TweetModal:p},data:function(){return{show:!1}},computed:Object(a["a"])({},Object(m["b"])(["currentUser"])),methods:{logout:function(){this.$store.commit("revokeAuthentication"),this.$router.push({name:"user-sign-in"})},openModal:function(){this.show=!0},closeModal:function(){this.show=!1}}},w=v,h=(r("d9e1"),Object(d["a"])(w,s,n,!1,null,"07c38a44",null));e["a"]=h.exports},3518:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("button",{staticClass:"btn-follow",class:{"btn-control":t.user.followed,"btn-control-outline":!t.user.followed},attrs:{disabled:t.isProcessing},on:{click:function(e){return t.toggleFollow(t.user.followed,t.user.id)}}},[t._v(" "+t._s(t.user.followed?"正在跟隨":"跟隨")+" ")])},n=[],a=r("1da1"),o=r("5530"),i=(r("96cf"),r("d9e2"),r("8845")),c=r("2fa3"),u={props:{initialUser:{type:Object,required:!0}},data:function(){return{user:{id:-1,followed:!1},isProcessing:!1}},watch:{initialUser:{handler:function(t,e){this.user=Object(o["a"])(Object(o["a"])({},this.user),t)},immediate:!0}},methods:{toggleFollow:function(t,e){t?this.unfollow(e):this.follow(e)},follow:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,i["a"].follow({userId:t});case 4:if(s=r.sent,n=s.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.user.followed=!0,e.$emit("user-followed"),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](0),c["a"].fire({icon:"error",title:"無法跟隨使用者，請稍後再試"});case 15:return r.prev=15,e.isProcessing=!1,r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[0,12,15,18]])})))()},unfollow:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,i["a"].unfollow({userId:t});case 4:if(s=r.sent,n=s.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.user.followed=!1,e.$emit("user-unfollowed"),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](0),c["a"].fire({icon:"error",title:"無法取消跟隨使用者，請稍後再試"});case 15:return r.prev=15,e.isProcessing=!1,r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[0,12,15,18]])})))()}}},l=u,d=(r("7d58"),r("2877")),f=Object(d["a"])(l,s,n,!1,null,"3c1ae105",null);e["a"]=f.exports},"44f5":function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"recommended-list"},[r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"list-container"},[r("div",{staticClass:"list-header"},[t._v(" Popular ")]),t._l(t.userList,(function(e){return r("section",{key:e.id},[r("div",{staticClass:"break"}),r("div",{staticClass:"user-container"},[r("span",{staticClass:"photo"},[r("UserThumbnail",{attrs:{"initial-user":e}})],1),r("span",{staticClass:"info"},[r("div",{staticClass:"name",attrs:{title:t.emptyName(e.name,e.account)}},[t._v(" "+t._s(t.emptyName(e.name,e.account))+" ")]),r("div",{staticClass:"account",attrs:{title:e.account}},[t._v(" "+t._s(t._f("addPrefix")(e.account))+" ")])]),r("span",{staticClass:"control"},[r("FollowControlButton",{attrs:{"initial-user":e}})],1)])])}))],2)])},n=[],a=r("1da1"),o=(r("96cf"),r("d9e2"),r("fb6a"),r("4de4"),r("d3b7"),r("8845")),i=r("2fa3"),c=r("2708"),u=r("d092"),l=r("3518"),d=r("4360"),f={components:{UserThumbnail:u["a"],FollowControlButton:l["a"]},mixins:[c["b"],c["a"]],data:function(){return{userList:[],isLoading:!1,userId:-1}},watch:{"$store.state.currentUser":{handler:function(t,e){""!==d["a"].state.token&&(this.userId=t.id,this.fetchUserList())},deep:!0,immediate:!0}},methods:{fetchUserList:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o["a"].getTopUsers();case 3:if(r=e.sent,"OK"===r.statusText){e.next=6;break}throw new Error(r.statusText);case 6:s=r.data,t.userList=s.filter((function(e){return e.id!==t.userId})).slice(0,10),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),i["a"].fire({icon:"error",title:"無法載入最受歡迎使用者資料，請稍後再試"});case 13:return e.prev=13,t.isLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})))()}}},p=f,m=(r("acfc"),r("2877")),v=Object(m["a"])(p,s,n,!1,null,"54639fbe",null);e["a"]=v.exports},"59f9":function(t,e,r){"use strict";r("8402")},6783:function(t,e,r){"use strict";r("a4d3"),r("e01a");var s=r("2fa3");e["a"]={get:function(t){var e=t.tweetId;return s["b"].get("/tweets/".concat(e))},getAll:function(){return s["b"].get("/tweets")},getReplies:function(t){var e=t.tweetId;return s["b"].get("/tweets/".concat(e,"/replies"))},post:function(t){var e=t.description;return s["b"].post("/tweets",{description:e})},postReply:function(t){var e=t.tweetId,r=t.comment;return s["b"].post("/tweets/".concat(e,"/replies"),{comment:r})},like:function(t){var e=t.tweetId;return s["b"].post("/tweets/".concat(e,"/like"))},unlike:function(t){var e=t.tweetId;return s["b"].post("/tweets/".concat(e,"/unlike"))}}},"769e":function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"tweet-input-box"},[r("section",{staticClass:"avatar-part"},[r("UserThumbnail",{attrs:{"initial-user":t.currentUser}})],1),r("section",{staticClass:"input-part"},[r("textarea",{directives:[{name:"model",rawName:"v-model.trim.lazy",value:t.description,expression:"description",modifiers:{trim:!0,lazy:!0}}],attrs:{placeholder:"有什麼新鮮事？",maxlength:"140"},domProps:{value:t.description},on:{change:function(e){t.description=e.target.value.trim()},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),r("div",{staticClass:"control-part"},[r("span",{staticClass:"error-message",attrs:{title:"error"}},[t._v(t._s(t.error))]),r("button",{staticClass:"btn-control btn-tweet",attrs:{disabled:t.isProcessing},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.tweet.apply(null,arguments)}}},[t._v(" 推文 ")])])])])},n=[],a=r("1da1"),o=r("5530"),i=(r("96cf"),r("a4d3"),r("e01a"),r("d9e2"),r("d092")),c=r("2708"),u=r("6783"),l=r("2f62"),d=r("2fa3"),f={components:{UserThumbnail:i["a"]},mixins:[c["c"]],props:{errorMessage:{type:String,required:!1,default:""}},data:function(){return{description:"",error:"",isProcessing:!1}},computed:Object(o["a"])({},Object(l["b"])(["currentUser"])),watch:{errorMessage:function(t){console.log(t),this.error=t}},methods:{tweet:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var r,s,n,a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,r=t.checkTweet(t.description),s=r.status,n=r.message,t.error="",!1!==s){e.next=7;break}return t.error=n,t.$emit("update-error",t.error),e.abrupt("return");case 7:return t.$emit("update-error",t.error),t.isProcessing=!0,e.next=11,u["a"].post({description:t.description});case 11:if(a=e.sent,o=a.data,"success"===o.status){e.next=15;break}throw new Error(o.status);case 15:i=o.tweetData,t.$emit("after-tweet",{id:i.id,userData:t.currentUser,description:t.description,replyAmount:0,likeAmount:0,userLiked:!1,createdAt:new Date}),t.description="",e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](0),console.log(e.t0),d["a"].fire({icon:"error",title:"發推失敗，請稍後再試"});case 24:return e.prev=24,t.isProcessing=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[0,20,24,27]])})))()}}},p=f,m=(r("a88e"),r("2877")),v=Object(m["a"])(p,s,n,!1,null,"f15bbad6",null);e["a"]=v.exports},"7d58":function(t,e,r){"use strict";r("8d1f")},8402:function(t,e,r){},"868e":function(t,e,r){},8845:function(t,e,r){"use strict";var s=r("2fa3");e["a"]={follow:function(t){var e=t.userId;return s["b"].post("/followships",{id:e})},unfollow:function(t){var e=t.userId;return s["b"].delete("/followships/".concat(e))},getTopUsers:function(){return s["b"].get("/followships/top10")},getFollowers:function(t){var e=t.userId;return s["b"].get("/users/".concat(e,"/followers"))},getFollowings:function(t){var e=t.userId;return s["b"].get("users/".concat(e,"/followings"))}}},"8d1f":function(t,e,r){},a88e:function(t,e,r){"use strict";r("08b7")},acfc:function(t,e,r){"use strict";r("af3f")},af3f:function(t,e,r){},d092:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("router-link",{staticClass:"photo-container",attrs:{to:{name:"user-main",params:{id:t.user.id}}}},[r("img",{directives:[{name:"show",rawName:"v-show",value:t.user.avatar,expression:"user.avatar"}],attrs:{src:t.user.avatar},on:{error:function(e){t.user.avatar=""}}})])},n=[],a=r("5530"),o={props:{initialUser:{type:Object,required:!0}},data:function(){return{user:{id:-1,avatar:""}}},watch:{initialUser:function(t){this.user=Object(a["a"])(Object(a["a"])({},this.user),t)}},created:function(){this.user=Object(a["a"])(Object(a["a"])({},this.user),this.initialUser)}},i=o,c=(r("01c8"),r("2877")),u=Object(c["a"])(i,s,n,!1,null,"34e062da",null);e["a"]=u.exports},d9e1:function(t,e,r){"use strict";r("209d")},fb6a:function(t,e,r){"use strict";var s=r("23e7"),n=r("da84"),a=r("e8b5"),o=r("68ee"),i=r("861d"),c=r("23cb"),u=r("07fa"),l=r("fc6a"),d=r("8418"),f=r("b622"),p=r("1dde"),m=r("f36a"),v=p("slice"),w=f("species"),h=n.Array,g=Math.max;s({target:"Array",proto:!0,forced:!v},{slice:function(t,e){var r,s,n,f=l(this),p=u(f),v=c(t,p),b=c(void 0===e?p:e,p);if(a(f)&&(r=f.constructor,o(r)&&(r===h||a(r.prototype))?r=void 0:i(r)&&(r=r[w],null===r&&(r=void 0)),r===h||void 0===r))return m(f,v,b);for(s=new(void 0===r?h:r)(g(b-v,0)),n=0;v<b;v++,n++)v in f&&d(s,n,f[v]);return s.length=n,s}})}}]);
//# sourceMappingURL=chunk-69390bcb.8314c6aa.js.map